## =============================================================================
## ResNet50 — ImageNet from-scratch training config
## =============================================================================
##
## Entry point:
##   python scripts/run_training.py --config configs/resnet50_imagenet.yaml
##
## Standard ResNet50 ImageNet recipe:
##   SGD + Nesterov momentum, cosine annealing LR with 5-epoch linear warmup,
##   100 epochs, batch size 256.
## =============================================================================


## ---TRAINING MODE--- ##
training_mode: scratch
use_ddp: true                 # DistributedDataParallel via torchrun --nproc_per_node=2


## ---PATHS--- ##
save_path: "/path/to/save/resnet50_imagenet"

# Root ImageNet directory — must contain train/ and val/ sub-folders
img_dir: "/path/to/imagenet"

# Only needed when perturb_epoch > 0 (load a pre-trained baseline first)
baseline_checkpoint_path:


## ---LOGGING & W&B--- ##
wandb_project:                # Optional: W&B project name (offline if blank)
wandb_entity:                 # Optional: W&B username / team

debug_logging: false


## ---TRAINING PARAMETERS--- ##
dataset_type: imagenet
max_duration: '100ep'         # 100 training epochs
early_stopping_patience: 20
batch_size: 256
criterion: CrossEntropyLoss
random_seed: 1
cuda: 0                       # ignored when use_ddp: true (torchrun sets LOCAL_RANK)
num_workers: 8                # DataLoader worker processes — match to --cpus-per-task in SLURM
pin_memory: true              # Pin CPU→GPU transfers for faster data loading


## ---OPTIMIZER & LR SCHEDULE--- ##
opt: sgd
lr: 0.1
momentum: 0.9
weight_decay: 1e-4
lr_scheduler: cosineannealinglrwithwarmup
lr_warmup_duration: '5ep'


## ---PERTURBATION PARAMETERS--- ##
## Supported: none | image_noise | uniform_images | label_shuffle
## (random_target is finetune-only)
perturb_type: none
perturb_epoch:
perturb_length:
perturb_seed:


## ---MODEL--- ##
architecture: RN50
pretrained: false             # true = load timm ImageNet weights; false = scratch
num_classes: 1000
